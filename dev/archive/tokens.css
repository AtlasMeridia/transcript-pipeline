/* ═══════════════════════════════════════════════════════════════
   ATLAS MERIDIA DESIGN TOKENS
   Version: 3.1
   Last updated: December 2025
   
   Usage: Import in globals.css after Tailwind base
   These tokens are the source of truth for all styling.
   ═══════════════════════════════════════════════════════════════ */

:root {
  /* ─────────────────────────────────────────────────────────────
     COLOR SYSTEM
     ───────────────────────────────────────────────────────────── */
  
  /* Navy Scale — desaturated, slightly warm */
  --navy-950: #08090c;
  --navy-900: #0e1318;
  --navy-800: #161c24;
  --navy-700: #1e2630;
  --navy-600: #2a3440;
  --navy-500: #3d4754;
  --navy-400: #5c6672;
  --navy-300: #7d8690;
  
  /* Warm Cream Scale — muted, paper-like */
  --cream-50: #f8f6f1;
  --cream-100: #f3f0ea;
  --cream-200: #eae6de;
  --cream-300: #dfd9ce;
  --cream-400: #d0c8bb;
  --cream-500: #b8b0a2;
  
  /* Amber-Gold Accent Scale */
  --accent-light: #ddb878;
  --accent: #c9924a;
  --accent-dark: #a87a3a;
  --accent-deep: #8a6530;
  
  /* Semantic Colors */
  --success: #6a9a70;
  --error: #b05454;
  --warning: var(--accent);
  
  /* ─────────────────────────────────────────────────────────────
     TYPOGRAPHY
     ───────────────────────────────────────────────────────────── */
  
  /* Font Families (set via next/font in layout.tsx) */
  --font-display: 'Cormorant Garamond', Georgia, serif;
  --font-body: 'Lora', Georgia, serif;
  --font-ui: 'DM Sans', system-ui, sans-serif;
  --font-mono: 'IBM Plex Mono', monospace;
  --font-chinese: 'Noto Serif TC', serif;
  
  /* Type Scale */
  --text-xs: 0.75rem;      /* 12px */
  --text-sm: 0.875rem;     /* 14px */
  --text-base: 1.125rem;   /* 18px */
  --text-body: 1.25rem;    /* 20px — primary reading size (tightened from 22px) */
  --text-lg: 1.5rem;       /* 24px */
  --text-xl: 1.75rem;      /* 28px */
  --text-2xl: 2.25rem;     /* 36px */
  --text-3xl: 3rem;        /* 48px */
  --text-4xl: 4rem;        /* 64px */
  --text-5xl: 5.5rem;      /* 88px */
  
  /* Line Heights */
  --leading-tight: 1.05;
  --leading-snug: 1.25;
  --leading-normal: 1.5;
  --leading-relaxed: 1.6;  /* Tightened from 1.65 */
  
  /* Letter Spacing */
  --tracking-tight: -0.02em;   /* Headlines */
  --tracking-body: -0.01em;    /* Body text */
  
  /* ─────────────────────────────────────────────────────────────
     SPACING
     ───────────────────────────────────────────────────────────── */
  
  --space-1: 0.25rem;   /* 4px */
  --space-2: 0.5rem;    /* 8px */
  --space-3: 0.75rem;   /* 12px */
  --space-4: 1rem;      /* 16px */
  --space-5: 1.5rem;    /* 24px */
  --space-6: 2rem;      /* 32px */
  --space-8: 3rem;      /* 48px */
  --space-10: 4rem;     /* 64px */
  --space-12: 6rem;     /* 96px */
  --space-16: 8rem;     /* 128px */
  --space-20: 10rem;    /* 160px */
  
  /* ─────────────────────────────────────────────────────────────
     LAYOUT
     ───────────────────────────────────────────────────────────── */
  
  --width-prose: 38rem;    /* ~608px — article body */
  --width-wide: 52rem;     /* ~832px — wide content */
  --width-full: 80rem;     /* ~1280px — max container */
  
  /* ─────────────────────────────────────────────────────────────
     MOTION
     ───────────────────────────────────────────────────────────── */
  
  --transition-fast: 150ms ease;
  --transition-base: 300ms ease;
  --transition-slow: 600ms cubic-bezier(0.16, 1, 0.3, 1);
  --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
  
  /* ─────────────────────────────────────────────────────────────
     EFFECTS
     ───────────────────────────────────────────────────────────── */
  
  --border-radius-sm: 4px;
  --border-radius: 6px;
  --border-radius-lg: 12px;
  
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.1);
  --shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.2);
}

/* ═══════════════════════════════════════════════════════════════
   LIGHT MODE THEME
   ═══════════════════════════════════════════════════════════════ */

:root,
[data-theme="light"] {
  --bg-primary: var(--cream-100);
  --bg-deep: var(--cream-50);
  --bg-elevated: var(--cream-50);
  --text-primary: var(--navy-700);
  --text-secondary: var(--navy-600);
  --text-muted: var(--navy-400);
  --border-color: var(--cream-400);
  
  --body-weight: 400;
  --body-tracking: 0;
  --accent-text: #a87a3a;  /* Darker for small text contrast */
}

/* ═══════════════════════════════════════════════════════════════
   DARK MODE THEME (Default for ATLAS Meridia)
   ═══════════════════════════════════════════════════════════════ */

[data-theme="dark"] {
  --bg-primary: var(--navy-900);
  --bg-deep: var(--navy-950);
  --bg-elevated: var(--navy-800);
  --text-primary: #d5cab8;
  --text-secondary: #bfb4a4;
  --text-muted: #9a8f80;
  --border-color: var(--navy-600);
  
  --body-weight: 300;
  --body-tracking: 0.01em;
  --accent-text: var(--accent);
}

/* System preference fallback */
@media (prefers-color-scheme: dark) {
  :root:not([data-theme="light"]) {
    --bg-primary: var(--navy-900);
    --bg-deep: var(--navy-950);
    --bg-elevated: var(--navy-800);
    --text-primary: #d5cab8;
    --text-secondary: #bfb4a4;
    --text-muted: #9a8f80;
    --border-color: var(--navy-600);
    
    --body-weight: 300;
    --body-tracking: 0.01em;
    --accent-text: var(--accent);
  }
}

/* ═══════════════════════════════════════════════════════════════
   BASE ELEMENT STYLES
   ═══════════════════════════════════════════════════════════════ */

/* Selection highlight */
::selection {
  background: rgba(201, 146, 74, 0.3);
  color: inherit;
}

/* Focus ring for accessibility */
:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

/* Smooth scrolling */
html {
  scroll-behavior: smooth;
}

/* ═══════════════════════════════════════════════════════════════
   PROSE STYLES (for Ghost content)
   Apply these to the wrapper around Ghost HTML output
   ═══════════════════════════════════════════════════════════════ */

.prose {
  font-family: var(--font-body);
  font-size: clamp(1.0625rem, 0.95rem + 0.4vw, 1.25rem); /* 17-20px, tightened */
  font-weight: var(--body-weight);
  letter-spacing: var(--tracking-body);
  line-height: var(--leading-relaxed);
  color: var(--text-primary);
  max-width: var(--width-prose);
}

.prose p {
  margin-bottom: var(--space-5);
}

/* Drop cap for first paragraph of articles */
.prose-drop-cap > p:first-of-type::first-letter {
  font-family: var(--font-display);
  font-size: 3.5em;
  font-weight: 500;
  float: left;
  line-height: 0.8;
  margin-right: 0.08em;
  margin-top: 0.05em;
  color: var(--accent);
}

/* Page title styles */
.page-title {
  letter-spacing: var(--tracking-tight);
}

.prose h2 {
  font-family: var(--font-display);
  font-size: var(--text-2xl);
  font-weight: 300;
  letter-spacing: var(--tracking-tight);
  line-height: var(--leading-snug);
  margin-top: var(--space-12);
  margin-bottom: var(--space-5);
  color: var(--text-primary);
}

.prose h3 {
  font-family: var(--font-display);
  font-size: var(--text-xl);
  font-weight: 400;
  letter-spacing: var(--tracking-tight);
  line-height: var(--leading-snug);
  margin-top: var(--space-8);
  margin-bottom: var(--space-4);
  color: var(--text-primary);
}

.prose a {
  color: var(--accent-text);
  text-decoration: underline;
  text-decoration-color: rgba(201, 146, 74, 0.4);
  text-underline-offset: 3px;
  transition: text-decoration-color var(--transition-fast);
}

.prose a:hover {
  text-decoration-color: var(--accent);
}

.prose strong {
  font-weight: 500;
  color: var(--text-primary);
}

.prose em {
  font-style: italic;
}

.prose blockquote {
  border-left: 3px solid var(--accent);
  padding-left: var(--space-6);
  margin: var(--space-6) 0;
  font-style: italic;
  color: var(--text-secondary);
}

.prose ul,
.prose ol {
  margin: var(--space-5) 0;
  padding-left: var(--space-6);
}

.prose li {
  margin-bottom: var(--space-2);
}

.prose li::marker {
  color: var(--accent);
}

.prose code {
  font-family: var(--font-mono);
  font-size: 0.875em;
  background: var(--bg-elevated);
  padding: 0.15em 0.4em;
  border-radius: var(--border-radius-sm);
  color: var(--accent-light);
}

.prose pre {
  background: var(--navy-950);
  border: 1px solid var(--navy-700);
  border-radius: var(--border-radius);
  padding: var(--space-5);
  overflow-x: auto;
  margin: var(--space-6) 0;
}

.prose pre code {
  background: transparent;
  padding: 0;
  font-size: var(--text-sm);
  color: var(--text-secondary);
}

.prose img {
  border-radius: var(--border-radius);
  margin: var(--space-6) 0;
}

.prose hr {
  border: none;
  height: auto;
  margin: var(--space-10) 0;
  text-align: center;
}

/* Section break ornament — three-dot divider */
.prose hr::before {
  content: '· · ·';
  display: block;
  font-family: var(--font-display);
  font-size: var(--text-lg);
  letter-spacing: 0.5em;
  color: var(--accent);
  opacity: 0.6;
}

/* Wide images */
.prose .kg-width-wide {
  width: calc(100% + 6rem);
  max-width: var(--width-wide);
  margin-left: -3rem;
  margin-right: -3rem;
}

/* Full-bleed images */
.prose .kg-width-full {
  width: 100vw;
  max-width: none;
  margin-left: calc(-50vw + 50%);
  margin-right: calc(-50vw + 50%);
  border-radius: 0;
}

/* ═══════════════════════════════════════════════════════════════
   GHOST CARD STYLES
   ═══════════════════════════════════════════════════════════════ */

/* Callout card */
.prose .kg-callout-card {
  background: linear-gradient(135deg, 
    rgba(201, 146, 74, 0.08) 0%, 
    rgba(138, 101, 48, 0.04) 100%);
  border: 1px solid rgba(201, 146, 74, 0.2);
  border-left: 4px solid var(--accent);
  border-radius: var(--border-radius);
  padding: var(--space-5);
  margin: var(--space-6) 0;
}

/* Bookmark card */
.prose .kg-bookmark-card {
  background: var(--bg-elevated);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  overflow: hidden;
}

.prose .kg-bookmark-content {
  padding: var(--space-5);
}

.prose .kg-bookmark-title {
  font-family: var(--font-ui);
  font-weight: 500;
  color: var(--text-primary);
}

.prose .kg-bookmark-description {
  font-size: var(--text-sm);
  color: var(--text-secondary);
  margin-top: var(--space-2);
}

/* ═══════════════════════════════════════════════════════════════
   UTILITY CLASSES
   ═══════════════════════════════════════════════════════════════ */

/* Text noise overlay (subtle texture) */
.texture-overlay::after {
  content: '';
  position: fixed;
  inset: 0;
  background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
  opacity: 0.03;
  pointer-events: none;
  z-index: 9999;
}

/* Dark mode image adjustment */
[data-theme="dark"] .prose img:not(.no-adjust) {
  filter: brightness(0.92) contrast(1.02);
}

/* ═══════════════════════════════════════════════════════════════
   SYNTAX HIGHLIGHTING
   Based on One Dark theme, adapted for ATLAS Meridia
   ═══════════════════════════════════════════════════════════════ */

.prose pre code .comment,
.prose pre code .prolog,
.prose pre code .doctype,
.prose pre code .cdata {
  color: #5c6370;
}

.prose pre code .punctuation {
  color: #abb2bf;
}

.prose pre code .property,
.prose pre code .tag,
.prose pre code .boolean,
.prose pre code .number,
.prose pre code .constant,
.prose pre code .symbol,
.prose pre code .deleted {
  color: #e06c75;
}

.prose pre code .selector,
.prose pre code .attr-name,
.prose pre code .string,
.prose pre code .char,
.prose pre code .builtin,
.prose pre code .inserted {
  color: #98c379;
}

.prose pre code .operator,
.prose pre code .entity,
.prose pre code .url {
  color: #56b6c2;
}

.prose pre code .atrule,
.prose pre code .attr-value,
.prose pre code .keyword {
  color: #c678dd;
}

.prose pre code .function,
.prose pre code .class-name {
  color: #61afef;
}

.prose pre code .regex,
.prose pre code .important,
.prose pre code .variable {
  color: #c9924a;
}

/* Line numbers for code blocks */
.prose pre code {
  counter-reset: line;
}

.prose pre code .line {
  display: block;
}

.prose pre code .line::before {
  counter-increment: line;
  content: counter(line);
  display: inline-block;
  width: 2rem;
  margin-right: 1rem;
  text-align: right;
  color: var(--navy-500);
  user-select: none;
}

/* ═══════════════════════════════════════════════════════════════
   CHINESE TYPOGRAPHY
   Applied when lang="zh-TW" attribute is set
   ═══════════════════════════════════════════════════════════════ */

[lang="zh-TW"],
[data-lang="zh-TW"] {
  font-family: var(--font-chinese);
}

[lang="zh-TW"] .font-display,
[data-lang="zh-TW"] .font-display {
  font-family: var(--font-chinese);
}

[lang="zh-TW"] .font-body,
[data-lang="zh-TW"] .font-body {
  font-family: var(--font-chinese);
}

[lang="zh-TW"] .prose,
[data-lang="zh-TW"] .prose {
  font-family: var(--font-chinese);
}
